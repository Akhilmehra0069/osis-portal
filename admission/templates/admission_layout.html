{% extends "layout.html" %}
{% load staticfiles %}
{% load i18n %}

{% comment "License" %}
* OSIS stands for Open Student Information System. It's an application
* designed to manage the core business of higher education institutions,
* such as universities, faculties, institutes and professional schools.
* The core business involves the administration of students, teachers,
* courses, programs and so on.
*
* Copyright (C) 2015-2016 Université catholique de Louvain (http://www.uclouvain.be)
*
* This program is free software: you can redistribute it and/or modify
* it under the terms of the GNU General Public License as published by
* the Free Software Foundation, either version 3 of the License, or
* (at your option) any later version.
*
* This program is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
* GNU General Public License for more details.
*
* A copy of this license - GNU General Public License - is available
* at the root of the source code of this program.  If not,
* see http://www.gnu.org/licenses/.
{% endcomment %}
{% block style %}
<link rel="stylesheet" href="{% static 'css/bootstrap-datepicker3.min.css' %}" type='text/css'>
{% endblock %}
{% block content %}
    <h2>{{ request.user.first_name }} {{ request.user.last_name }}</h2>
    <span>
        La procédure de demande d'inscription en ligne est divisée en plusieurs onglets. La demande d'inscription ne
        pourra être validée que lorsque tous les onglets auront valablement été complétés. Les icônes
        <font class="green">verte <span class="glyphicon glyphicon-ok-sign" aria-hidden="true" style="color:green;"></span></font>
        ou <font class="green">orange <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true" style="color:orange;"></span></font>
        vous rappellent l'état d'avancement de votre demande d'inscription que vous pouvez d'ailleurs arrêter et
        reprendre à tout moment.
    </span>
    <div>
        <br>
        <a id="lnk_previous_step"
           class="btn btn-default"
           {%if tab_active == 0 %}disabled{%endif%}
           href="{%if tab_active == 1 %}{% url 'profile'%}{%endif%}
                 {%if tab_active == 2 %}{% url 'diploma_update'%}{%endif%}
                 {%if tab_active == 3  or tab_active == 31%}{% url 'curriculum_update'%}{%endif%}
                 {%if tab_active == 4 %}{% url 'applications'%}{%endif%}
                 {%if tab_active == 5 %}{% url 'sociological_survey'%}{%endif%}"
           title="{%if tab_active == 1 %}{% trans 'profile'%}{%endif%}
                  {%if tab_active == 2 %}{% trans 'diploma'%}{%endif%}
                  {%if tab_active == 3  or tab_active == 31 %}{% trans 'curriculum'%}{%endif%}
                  {%if tab_active == 4 %}{% trans 'demandes'%}{%endif%}
                  {%if tab_active == 5 %}{% trans 'sociological_survey'%}{%endif%}"><span class="glyphicon glyphicon-step-backward" aria-hidden="true"></span>
            {%trans 'previous_step'%}</a>
        <a id="lnk_save_up" name="bt_save_up" class="btn btn-primary"
           onclick="{%if tab_active == 0 %}save('form_profile');{%endif%}
                    {%if tab_active == 1 %}save('form_secondary_education');{%endif%}
                    {%if tab_active == 2 %}save('form_curriculum');{%endif%}
                    {%if tab_active == 3  or tab_active == 31%}save('form_questions');{%endif%}
                    {%if tab_active == 4 %}save('form_sociological_survey');{%endif%}
                    {%if tab_active == 5 %}save('form_attachments');{%endif%}"
           title="{%trans 'save'%}"><span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"></span>
            {%trans 'save'%}</a>
        <a id="lnk_next_step"
           class="btn btn-default"
           {%if tab_active == 5 %}disabled{%endif%}
           href="{%if tab_active == 0 %}{% url 'diploma_update'%}{%endif%}
                 {%if tab_active == 1 %}{% url 'curriculum_update'%}{%endif%}
                 {%if tab_active == 2 %}{% url 'applications'%}{%endif%}
                 {%if tab_active == 3  or tab_active == 31%}{% url 'sociological_survey'%}{%endif%}
                 {%if tab_active == 4 %}{% url 'attachments'%}{%endif%}"
           title="{%if tab_active == 0 %}{% trans 'diploma'%}{%endif%}
                  {%if tab_active == 1 %}{% trans 'curriculum'%}{%endif%}
                  {%if tab_active == 2 %}{% trans 'demandes'%}{%endif%}
                  {%if tab_active == 3  or tab_active == 31%}{% trans 'sociological_survey'%}{%endif%}
                  {%if tab_active == 4 %}{% trans 'attachments'%}{%endif%}"><span class="glyphicon glyphicon-step-forward" aria-hidden="true"></span>
            {%trans 'next_step'%}</a>
        {%if message_success%}
            <br>
            <font class="alert alert-success" role="alert" style="margin-left:5px;">
                {{message_success}}
            </font>
        {% endif %}
    </div>
    <br>
    <ul class="nav nav-tabs">
        <li class="{%if tab_active == 0 %}active{%endif%}">
            <a href="{% url 'profile' %}" id="lnk_profile_tab">
                {%if validated_profil%}
                    <span class="glyphicon glyphicon-ok-sign" aria-hidden="true" style="color:green;"></span>
                {%else%}
                    <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true" style="color:orange;"></span>
                {%endif%}
                &nbsp;&nbsp;{%trans 'profile'%}</a>
        </li>
        <li class="{%if tab_active == 1 %}active{%endif%}">
            <a href="{% url 'diploma_update'%}" id="lnk_diploma_tab">
                {%if validated_diploma%}
                    <span class="glyphicon glyphicon-ok-sign" aria-hidden="true" style="color:green;"></span>
                {%else%}
                    <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true" style="color:orange;"></span>
                {%endif%}
                &nbsp;&nbsp;{%trans 'tab_diplomas'%}</a>
        </li>
        <li class="{%if tab_active == 2 %}active{%endif%}">
            <a href="{% url 'curriculum_update' %}" id="lnk_curriculum_tab">
                {%if validated_curriculum %}
                    <span class="glyphicon glyphicon-ok-sign" aria-hidden="true" style="color:green;"></span>
                {%else%}
                    <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true" style="color:orange;"></span>
                {%endif%}
                &nbsp;&nbsp;{%trans 'curriculum'%}</a>
        </li>
        <li class="{%if tab_active == 3 or tab_active == 31 %}active{%endif%}">
            <a href="{% url 'applications' %}" id="lnk_application_tab">
                {%if validated_applications%}
                    <span class="glyphicon glyphicon-ok-sign" aria-hidden="true" style="color:green;"></span>
                {%else%}
                    <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true" style="color:orange;"></span>
                {%endif%}
                &nbsp;&nbsp;{%trans 'demandes'%}</a>
        </li>
        <li class="{%if tab_active == 4 %}active{%endif%}">
            <a href="{% url 'sociological_survey' %}" id="lnk_sociological_tab">
                <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true" style="color:orange;"></span>
                &nbsp;&nbsp;{%trans 'sociological_survey'%}</a>
        </li>
        <li class="{%if tab_active == 5 %}active{%endif%}">
            <a href="{% url 'attachments' %}" id="lnk_attachments_tab">
                <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true" style="color:orange;"></span>
                &nbsp;&nbsp;{%trans 'attachments'%}</a>
        </li>
    </ul>
    <br>
    {%if tab_demande_active >= 0 and tab_demande_active < 3 and application.offer_year%}
        <h4>{{application.offer_year.title}}</h4>
    {%endif%}

    <div class="panel panel-default">
        <div class="panel-body">
            {%if tab_active != 4 %}
            <h5>{% trans 'mandatory_asterisk'%}</h5>
            {%endif%}
            {% block admission_tabs %}
            {% endblock %}
        </div>
    </div>
{% endblock %}

{% block script %}
    <script src="{% static 'js/bootstrap-datepicker.min.js' %}"></script>
    <script>

    $(document).ready(function() {
        if($("#slt_nationality").val()){
            $.ajax({
                url: "/admission/country?nationality=" + $("#slt_nationality").val()
            }).then(function(data) {

                if (data.european_union) {
                    $('#pnl_assimilation_criteria').css('visibility', 'hidden').css('display','none');
                }else{
                    $('#pnl_assimilation_criteria').css('visibility', 'visible').css('display','block');
                }
            });
        }
    });

    function save(form_to_submit){
        id = 'form#' + form_to_submit;
        $(id).submit();

    }
    </script>
{% endblock %}